---
title: "Marathon Training Plan Data Analysis"
#author: "Steve Newns"
#date: "February 24, 2017"
output:
  github_document: default
  html_document: default
  word_document: default
---

# *Initial Data Inspection*

Fist, I load in the CSV file created in the **R_Cleaning_Garmin_Strava** script file, which contains the combined dataset of runs from my Philadelphia Marathon training plan from both Strava and Garmin Connect. I then inspect the data to make sure I have all the correct data in the correct data types.

```{r load dataset, echo = FALSE}
runs <- read.csv("cleanedMarathonTrainingData.csv")
str(runs)
```

Well, to start off, I have a column which seems to contain the row numbers from the CSv, so let's remove that before going back to the inspection.

```{r remove 1st col }
runs$X <- NULL
head(runs,2)
```

Alright, cool. But it looks like my run time field, **Time**, and average pace (min/mile) field, **Avg.Pace**, are not in the POSIXct format needed. So let's put them back into the correct format.

```{r fix POSIXct}
runs$Time <- as.POSIXct(runs$Time)#, format = '%H:%M:%S')
runs$Avg.Pace <- as.POSIXct(runs$Avg.Pace)#, format = '%H:%M:%S')
str(runs)
```

Looks like **Month** was also not loaded as on *ordered* factor like I need it. As it is now, if I used it in my graphs, it would be ordereded alphabetically, not chronologically like I need it. So let's convert it back to an ordered factor with the correctly-specified ordering via the **levels** argument.

```{r fix month}
runs$Month <- factor(runs$Month, ordered = TRUE, levels = c("Jul","Aug","Sep","Oct","Nov"))
```

Now its time to acually make some plots. I'll start off with a simple histogram of how many miles I ran in each of my runs.

```{r plotting, echo = FALSE}
library(ggplot2)
library(RColorBrewer)


#distance histogram
ggplot(data = runs, aes(x = Distance)) + 
  geom_histogram(binwidth = 2, aes(fill = ..count..), colour = "black", boundary = 2) + 
  xlab("Distance (mi)") + 
  ylab("Frequency") + 
  ggtitle("Distribution of Miles Ran in All Runs") + 
  guides(fill=FALSE)
  
```

It looks like the majority of my runs (20 of 'em) were between 10 and 12 miles, with the next highest frequency being from 4 to 6 miles, which were mostly recovery runs, showing that there was indeed a lot decent amount of time for recovery in this plan. We can also see my one 24 mile run all the way to the right, my longest Long Run of the plan.

Now let's look at the total number of miles ran each month, with a pretty obvious expectation to see the total rise month-by-month.

```{r miles by month, echo = FALSE} 
#miles by month bars
ggplot(data = runs, aes(x = Month, y = Distance, fill = Month)) + 
  geom_bar(stat="identity") +
  xlab("Month") + 
  ylab("Total Miles") + 
  guides(fill=FALSE) +
  ggtitle("Total Miles by Month")
tapply(runs$Distance,runs$Month,sum)
```

The largest number of miles ran, 308 miles, was in September, and then we see a *ever-so-slightly* drop to 304 miles in October. (peak week in September?). Then we see the large drop from October to November, which was expected due tapering up the race and the fact that the race was on November 20th, so there's no more run data after that date.


#avg. cadence grouped by month
```{r cadence by month} 
ggplot(data = runs, aes(Month, Cad)) + 
  geom_jitter(aes(colour = Month)) +
  geom_boxplot(aes(fill = Month), 
               outlier.colour = "black", alpha = 0.5) + #geom_jitter()
  xlab("Month") + 
  ylab("Cadence") + 
  ggtitle("Cadence per Month") + 
  labs(caption="*Cadence generally increases month over month, due to more workouts, or improved form?")
```

#avg. HR grouped by month
```{r HR by month boxplot}
ggplot(data = runs, aes(Month, Avg.HR)) + 
  geom_jitter(aes(colour = Month)) +
  geom_boxplot(aes(fill = Month), 
               outlier.colour = "black", alpha = 0.5) + #geom_jitter()
  xlab("Month") + 
  ylab("Cadence") + 
  ggtitle("Cadence per Month") + 
  labs(caption="*HR generally decreases month over month --> increased fitness or cooler weather?")
#tbl <- tapply(runs$Avg.HR,runs$Month,median)
```

#average heart rate per run over plan --> line
```{r HR over time} 
ggplot(data = runs, aes(x = Date, y = Avg.HR)) + 
  geom_line(aes(group=1)) +
  theme(axis.text.x = element_blank()) +
  xlab("Time") + 
  ylab("Average Heart Rate") + 
  ggtitle("Average Heart Rate Over Time") + 
  labs(caption="*Very slight general decrease, with outliers of about 100 in the 1st third of the plan and 
70 in the last 3rd of the plan")
```

#average pace over plan line
```{r avg pace}
ggplot(data = runs, aes(x = Date, y = Avg.Pace)) + 
  geom_point() + # by color? 
  #?stat_smooth() + 
  theme(axis.text.x = element_blank()) +
  xlab("Time") + 
  ylab("Average Heart Rate") + 
  ggtitle("Average Heart Rate Over Time") + 
  labs(caption="*Very slight general decrease, but not linear")
```

#cadence boxplot by run type
```{r cadence by run type}
ggplot(data = runs, aes(x=RunType, y=Cad, fill = RunType)) + 
  geom_boxplot(alpha = 0.5) + 
  geom_jitter(aes(colour = RunType)) +
    #stat_summary(fun.y="median", geom="bar", alpha = 0.1) + 
  expand_limits(y = 130) + 
  xlab("Run Type") + 
  ylab("Cadence") + 
  coord_flip() + 
  ggtitle("Cadence by Run Type") + 
  labs(caption="*The actual marathon had the highest cadence, which makes sense. Workouts had widest variety - 
       inspect more, recovery runs abit slower, but less variant, long runs second slowest")
```